---
import SEO from '@components/SEO.astro';
import StructuredData from '@components/StructuredData.astro';
import Header from '@components/Header.astro';
import SideDots from '@components/SideDots.astro';
import WhatsAppButton from '@components/WhatsAppButton.astro';
import '@styles/global.css';
import '@styles/variables.css';
import '@styles/animations.css';

export interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
}

const {
  title = 'Dr. Gustavo Mendes - Psiquiatria',
  description = 'Psiquiatria humanizada com consultas de 2 horas. Especialista em TDAH, autismo e neurodiversidade. São José do Rio Preto.',
  ogImage,
} = Astro.props;
---

<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />

    <SEO
      title={title}
      description={description}
      ogImage={ogImage}
    />

    <StructuredData />

    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://app.cal.com" />

    <!-- Critical CSS inline -->
    <style is:inline>
      /* Critical CSS for above-the-fold */
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
        overflow-x: hidden;
      }

      /* Skip to content (accessibility) */
      .skip-to-content {
        position: absolute;
        top: -40px;
        left: 0;
        background: #1A1A1A;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        z-index: 10000;
      }

      .skip-to-content:focus {
        top: 0;
      }

      /* Prevent FOUC */
      section {
        min-height: 100vh;
      }
    </style>
  </head>
  <body>
    <!-- Skip to content link (accessibility) -->
    <a href="#main-content" class="skip-to-content">
      Pular para o conteúdo principal
    </a>

    <!-- Top navigation bar -->
    <Header />

    <!-- Side dots navigation (6 sections) -->
    <SideDots />

    <!-- Main content -->
    <main id="main-content">
      <slot />
    </main>

    <!-- WhatsApp button (fixed bottom-right) -->
    <WhatsAppButton />

    <!-- Cloudflare Web Analytics (placeholder - substituir token) -->
    <script
      defer
      src='https://static.cloudflareinsights.com/beacon.min.js'
      data-cf-beacon='{"token": "YOUR_TOKEN_HERE"}'
    ></script>
  </body>
</html>

<style>
  /* Global skip-to-content styling */
  .skip-to-content {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--color-text-primary);
    color: var(--color-bg-primary);
    padding: var(--space-xs) var(--space-md);
    text-decoration: none;
    z-index: 10000;
    transition: top var(--duration-fast) ease;
  }

  .skip-to-content:focus {
    top: 0;
  }
</style>
